<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Review - <%= movie.title %>
    </title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;700&family=Roboto:wght@400;700&display=swap"
        rel="stylesheet">

    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- เรียกใช้ config แยก -->
    <script src="/js/tailwind-config.js"></script>

    <!-- Alpine.js -->
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>

<body class="font-sans text-sm text-white bg-gradient-to-b from-[#1F1F1F] via-[#121212] to-[#000000]">

    <!-- HEADER -->
    <%- include('partials/header') %>

        <div class="bg-white shadow-lg rounded-2xl max-w-4xl w-full p-6 flex flex-col gap-6 mx-auto my-12">

            <!-- Row สำหรับปุ่มย้อนกลับ ชิดขวา -->
            <div class="flex justify-start">
                <a href="/movie/detail/<%= movie.movieId %>"
                    class="inline-block text-black hover:underline px-4 py-2 ">
                 ย้อนกลับ
                </a>
            </div>

            <!-- Row สำหรับโปสเตอร์และข้อมูลหนัง -->
            <div class="flex flex-col lg:flex-row gap-6 text-black">

                <!-- Movie Poster -->
                <img src="<%= movie.posterPath.startsWith('http') ? movie.posterPath : 'https://image.tmdb.org/t/p/w500' + movie.posterPath %>"
                    alt="<%= movie.title %>" class="w-full lg:w-1/3 rounded-lg shadow-md">

                <!-- Movie Info & Form -->
                <div class="flex-1">
                    <h1 class="text-3xl font-bold mb-2">
                        <%= movie.title %>
                    </h1>
                    <p class="mb-2">ปี: <%= movie.releaseDate.substring(0,4) %> | เรทติ้ง : <%= movie.avgRating || 'N/A'
                                %>/10</p>
                    <p class="mb-4">
                        <%= movie.overview %>
                    </p>

                    <% if (movie.genres && movie.genres.length>0) { %>
                        <p class="mb-4">
                            ประเภท:
                            <% movie.genres.forEach(g=> { %>
                                <span class="inline-block bg-gray-200 px-2 py-1 rounded-full text-sm mr-2">
                                    <%= g.name %>
                                </span>
                                <% }) %>
                        </p>
                        <% } %>

                            <!-- Review Form -->
                            <form action="/reviews" method="POST"
                                class="space-y-1 bg-white p-4 rounded-lg ">

                                <input type="hidden" name="movieId" value="<%= movie.movieId %>">
                                <input type="hidden" name="title" value="<%= movie.title %>">
                                <input type="hidden" name="posterPath" value="<%= movie.posterPath %>">
                                <input type="hidden" name="releaseDate" value="<%= movie.releaseDate %>">

                                <!-- Rating -->
                                <div>
                                    <label for="rating" class="block font-medium mb-1">Rating</label>
                                    <select name="rating" id="rating" required
                                        class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500">
                                        <option value="">Select rating</option>
                                        <% for(let i=1;i<=10;i++){ %>
                                            <option value="<%= i %>">
                                                <%= i %> ⭐<%= '⭐' .repeat(i-1) %>
                                            </option>
                                            <% } %>
                                    </select>
                                </div>

                                <!-- Comment -->
                                <div>
                                    <label for="comment" class="block font-medium mb-1">Comment</label>
                                    <textarea name="comment" id="comment" rows="4" placeholder="Write your review..."
                                        required
                                        class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500"></textarea>
                                </div>

                                <!-- Submit Button -->
                                
                                <div class="flex justify-end">
                                    <button type="submit"
                                        class="bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-6 w-auto max-w-sm rounded-md transition-colors">
                                        Submit Review
                                    </button>
                                </div>

                            </form>
                </div>
            </div>
        </div>


</body>

</html>